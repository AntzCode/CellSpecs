<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Battery Master</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/lodash@4.17.21/lodash.min.js"></script>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div id="header">
        <img src="logo-300x300.png" alt="Cell Specs Logo" id="logo">
        <h1>Battery Master</h1>
        <button id="logout">Logout</button>
    </div>
    <div id="stats"></div>
    <div id="bracket-stats"></div>
    <p class="instructions">Use the buttons below to add new cells, edit existing ones, or manage your data. Click "Add New Cell" to start entering battery specs, or click "Enter Edit Mode" and then click on the cells to select them, then use "Edit Selected Cells" for bulk updates. </p>
    <div class="controls">
        <div class="left-buttons">
            <button id="add-cell" title="Start adding a new cell with basic specifications">Add New Cell</button>
            <button id="toggle-edit-mode" title="Enable selection mode to choose multiple cells for bulk editing">Enter Edit Mode</button>
            <button id="edit-selected" style="display:none;" title="Edit the selected cells one by one in sequence">Edit Selected Cells</button>
            <button id="export-jsonl" title="Download all cell data as a JSONL file for backup or transfer">Export JSONL</button>
            <input type="file" id="import-file" accept=".jsonl" title="Select a JSONL file from a previous export to merge into the current data">
            <button id="import-jsonl" title="Merge data from the selected JSONL file into the current cell list">Import JSONL</button>
        </div>
        <select id="stage-filter" title="Filter the cell list to show only cells in the selected testing stage">
            <option value="all">Show All</option>
            <option value="0">New</option>
            <option value="1">Testing</option>
            <option value="2">Charging</option>
            <option value="3">On hold</option>
            <option value="4">Tested</option>
        </select>
    </div>
    <ul id="cell-list"></ul>
    <div id="form-container" style="display:none;">
        <form id="cell-form">
            <h2 id="form-title">Add Cell</h2>
            <div id="stage-0" class="stage">
                <label>Cell Number: <input type="number" id="cell-number" required></label><br>
                <label>First Voltage: <input type="number" step="0.01" id="first-voltage" required></label><br>
                <label>Internal Resistance: <input type="number" step="0.01" id="internal-resistance" required></label><br>
            </div>
            <div id="stage-1" class="stage" style="display:none;">
                <label>First Charge Voltage: <input type="number" step="0.01" id="first-charge-voltage"></label><br>
            </div>
            <div id="stage-2" class="stage" style="display:none;">
                <label>Capacity mAh: <input type="number" id="capacity-mah"></label><br>
                <label>Capacity mWh: <input type="number" id="capacity-mwh"></label><br>
                <label>Voltage When Flat: <input type="number" step="0.01" id="voltage-flat"></label><br>
            </div>
            <div id="stage-3" class="stage" style="display:none;">
                <label>Voltage After Recharge: <input type="number" step="0.01" id="voltage-recharge"></label><br>
            </div>
            <div id="stage-4" class="stage" style="display:none;">
                <label>Voltage After 7 Days: <input type="number" step="0.01" id="voltage-7days"></label><br>
                <label>IR After 7 Days: <input type="number" step="0.01" id="ir-7days"></label><br>
            </div>
            <button type="button" id="save-next" title="Save current data and move to the next cell or stage">Save and Next</button>
            <button type="button" id="save" title="Save current data and stay on this cell">Save</button>
            <button type="button" id="cancel" title="Discard changes and close the form">Cancel</button>
        </form>
    </div>
    <script src="app.js"></script>
    <footer>
        <span>Made by <a href="https://x.ai/news/grok-code-fast-1"><svg width="16" height="16" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" style="vertical-align: middle;"><path d="M2.30047 8.77631L12.0474 23H16.3799L6.63183 8.77631H2.30047ZM6.6285 16.6762L2.29492 23H6.63072L8.79584 19.8387L6.6285 16.6762ZM17.3709 1L9.88007 11.9308L12.0474 15.0944L21.7067 1H17.3709ZM18.1555 7.76374V23H21.7067V2.5818L18.1555 7.76374Z" fill="currentColor"></path></svg> Grok</a></span>
        <a href="https://github.com/AntzCode/BatteryMaster" target="_blank"><svg width="20" height="20" viewBox="0 0 16 16"><path fill="currentColor" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"/></svg> View on GitHub</a>
    </footer>
</body>
</html>